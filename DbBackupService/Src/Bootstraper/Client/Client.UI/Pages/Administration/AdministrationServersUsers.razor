@page "/administration/serversusers"

@using Modules.Backup.Shared.Dtos

<PageTitle>Manage Users in Servers</PageTitle>

<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="pa-6">
    <MudText Typo="Typo.h4" Color="Color.Primary" Class="mb-6">Manage users in servers</MudText>

    <MudPaper Class="pa-4 mud-elevation-2 rounded-2xl">
        <MudStack Row="true" JustifyContent="SpaceBetween" AlignItems="AlignItems.Center" Class="mb-4">
            <MudText Typo="Typo.h6">Servers</MudText>
        </MudStack>

        <!-- Tabela grup -->
        <MudTable Items="@serversUsers" Hover="true" Bordered="false" Dense="true">
            <HeaderContent>
                <MudTh>Server Id</MudTh>
                <MudTh>Server Name</MudTh>
                <MudTh>Status</MudTh>
                <MudTh>Users with Access</MudTh>
                <MudTh>Operations</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Id">
                    <MudTooltip Delay="100" Text="@context.ServerId.ToString()">
                        @context.ServerId.ToString()[..8]...
                    </MudTooltip>
                </MudTd>
                <MudTd DataLabel="Name">@context.ServerConnectionName</MudTd>
                <MudTd DataLabel="Status">
                    @if (context.IsServerDisabled)
                    {
                        <MudChip T="string" Variant="Variant.Text" Color="Color.Error">Disabled</MudChip>
                    }
                    else
                    {
                        <MudChip T="string" Variant="Variant.Text" Color="Color.Success">Enabled</MudChip>
                    }
                </MudTd>
                <MudTd DataLabel="Access">@context.UsersWithAccess users</MudTd>
                <MudTd>
                    <MudTooltip Delay="100" Text="Toggle server status">
                        <MudIconButton Icon="@Icons.Material.Filled.ChangeCircle" Color="Color.Secondary" />
                    </MudTooltip>
                    <MudTooltip Delay="100" Text="Manage users that access this server">
                        <MudIconButton Icon="@Icons.Material.Filled.People" Color="Color.Primary"/>
                    </MudTooltip>
                </MudTd>
            </RowTemplate>

            <PagerContent>
                <MudTablePager PageSizeOptions="@([10, 25, 50])" />
            </PagerContent>
        </MudTable>
    </MudPaper>
</MudContainer>

@code {
    private List<ServersUsersListDto> serversUsers = new()
    {
        new ServersUsersListDto(Guid.CreateVersion7(), true, "Localhost", 2),
        new ServersUsersListDto(Guid.CreateVersion7(), false, "Domain", 1),
        new ServersUsersListDto(Guid.CreateVersion7(), false, "Sql Important Server", 1)
    };
}